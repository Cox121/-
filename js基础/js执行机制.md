# 执行上下文
`js`代码先编译后执行，在编译过程中生成执行上下文。执行上下文内部包含了变量环境，词法环境，this指向。  
执行上下文分为：  
1. 全局执行上下文：`js`文件在浏览器中加载完成后会先进行编译生成全局执行上下文。
2. 函数执行上下文：函数在被调用时才会进行编译，编译过程中生成函数执行上下文。
3. `eval`执行上下文  

## 变量环境
变量环境负责保存`var`声明的变量、声明的函数和负责指向上层作用域的`outer`。  

## 词法环境
词法环境负责保存`let`、`const`声明的变量，并维护了块级作用域。  

## `this`
this对象  

# 调用栈
`js`代码在执行前进行编译，将编译产生的执行上下文压入调用栈栈顶，在执行完成后销毁。  
一般栈底都是全局执行上下文。  
调用栈有大小，无限制的递归调用会导致调用栈溢出。  
`console.trace`可以打印出当前函数的调用栈信息。  

# 作用域及作用域链
作用域类似于唯一且确定之后不会改变的用来存储执行上下文的区域。  
作用域分为全局作用域和函数作用域，由于`js`采用了词法作用域方案，所以在函数声明的时候就决定它的作用域和上级作用域。但是作用域内变量的值是在执行过程中确定的。  
产生闭包的时候一个作用域也可能对应多个执行上下文。  

## 变量在作用域中查找的步骤
1. 先找到作用域对应的执行上下文
2. 从执行上下文的词法环境中上下往下查找在块级作用域中声明的变量
3. 从执行上下文的变量环境中从上往下查找
4. 从执行上下文的变量环境中的`outer`找到上级作用域，并重复步骤`1`
5. 直到全局作用域都没有找到对应变量，则返回`undefined`或者报错  

通过`outer`关联起来的层层作用域称之为作用域链。

# `this`
`this`分为：  
1. 全局执行上下文中的`this`：严格模式下为`undefined`，普通模式下为`window`。  
2. 函数执行上下文中的`this`：依据调用环境而定，一般情况下在全局环境中调用函数，`this`指向`window`或者`undefined`。  

## 改变`this`的方式
1. `call`、`bind`、`apply`
2. 通过对象内部调用