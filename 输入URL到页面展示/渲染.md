# 1. 解析`HTML`
渲染进程解析`HTML`，将其转化为浏览器能够理解的结构——`DOM Tree`。
# 2. 样式计算
## 2.1 解析`CSS`
渲染进程解析`CSS`，包括`link`标签引入的外部文件、`style`标签内的内部样式和`DOM`上的内联样式，生成浏览器能够理解的结构——`StyleSheets`。  
## 2.2 标准化样式
将开发者编写的样式进行标准化，如：
* 将颜色如`blue`、`white`等转化为`rgb`值。
* 将单位如`em`、`vh`等转化为准确的`px`。
## 2.3 样式计算
根据`CSS`的继承和层叠规则，计算出最终的`CSS`样式——`ComputedStyle`。
# 3. 布局
## 3.1 生成`Layout Tree`
遍历`DOM Tree`，结合每个元素的`ComputedStyle`，生成`Layout Tree`。  
`Layout Tree`上不包含不可见的元素。
## 3.2 布局计算
遍历`Layout Tree`，计算每个元素的位置，并写回到`Layout Tree`上。
# 4. 分层
处理`Layout Tree`，对节点进行分层，有以下特点之一会被分到单独图层：
* 拥有层叠上下文样式属性
  * `position`
  * `filter`
  * `opacity`
  * `z-index` 
* 会被裁剪
> 裁剪：子节点组成的内容超过了父节点内容的大小仅显示一部分，称为子节点被裁剪。  

裁剪的部分会单独分为一个图层，如果有滚动条，滚动条也会单独分一个图层。
# 5. 构建待绘制指令表
渲染进程的主线程为每个图层生成一系列绘制指令，并组成待绘制指令表，生成完成后将待绘制表提交给合成线程。
# 6. 栅格化
> 栅格化：将图块转化为位图。  

合成线程将图层划分为图块，一般图块大小为`256*256`或者`512*512`。  
合成线程会将视口附近的图块优先进行栅格化。  
合成线程将图块提交给栅格化线程池生成位图，如果开启了`GPU`加速，栅格化线程池会将生成位图的任务提交给`GPU`。  
# 7. 合成和显示
图块完成栅格化后，合成线程会生成绘制图块的指令并发送给浏览器进程，浏览器进程接收消息，将内容绘制到内存上，最后将内存显示在屏幕上。